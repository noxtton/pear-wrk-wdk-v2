global.BareKit = { IPC: require('../src/lib/ipc').serverStream }
require('../src/wdk-worklet')
const IPC = require('../src/lib/ipc').clientStream
const HRPC = require('../spec/hrpc')
const rpc = new HRPC(IPC)
const os = require('os');
const USDT_BALANCE_ADDRESSES = {
  ethereum: '0xdAC17F958D2ee523a2206206994597C13D831ec7',
  polygon: '0xc2132d05d31c914a87c6611c10748aeb04b58e8f',
  arbitrum: '0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9',
  ton: 'EQCxE6mUtQJKFnGfaROTKOt1lZbDiiX1kCixRv7Nw2Id_sDs',
}

const XAUT_BALANCE_ADDRESSES = {
  ethereum: '0x68749665FF8D2d112Fa859AA293F07A622782F38',
  polygon: '0xF1815bd50389c46847f0Bda824eC8da914045D14',
  arbitrum: '0x40461291347e1eCbb09499F3371D3f17f10d7159',
  ton: 'EQA1R_LuQCLHlMgOo1S4G7Y7W1cd0FrAkbA10Zq7rddKxi9k',
}

async function init () {
  console.log('init started')
  try {
    const workletStatus = await rpc.workletStart({
      enableDebugLogs: 0,
      seedPhrase: 'clump cherry rural carry lazy blade gain high holiday point witness when',
      // seedPhrase: 'rack cruise mouse aspect wise model abstract acquire crack chicken defense blue',
      config: JSON.stringify(require('../chains.json')),
    })
    console.log('worklet status: ', workletStatus)
  } catch (error) {
    console.log(error)
  }
  try {
    // const approveTx = await rpc.getApproveTransaction({
    //   token: USDT_BALANCE_ADDRESSES['polygon'],
    //   recipient: '0x38630c8ec92494CF96ded12060d8136B75e7a8b5',
    //   amount: 1001000,
    // })
    // console.log('approve transaction', approveTx)

    // const polygonSendTransaction = await rpc.abstractedSendTransaction({
    //   network: 'polygon',
    //   accountIndex: 0,
    //   options: JSON.stringify([
    //     approveTx,
    //     {
    //       to: "0x38630c8ec92494CF96ded12060d8136B75e7a8b5",
    //       chainId: 137,
    //       data: "0x9be111d100000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000340000000000000000000000000000000000000000000000000000000000000048000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f000000000000000000000000d5ccaa44681fe3afd553b11b291e02ed2f647db7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400146d4500b7c522aae33021af01eb1b2d22c69ce0ce29e64876585df8890e3850000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000f3a7000000000000000000000000000000000000000000000000000000000000f3a700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d5ccaa44681fe3afd553b11b291e02ed2f647db7000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064a9059cbb000000000000000000000000f70da97812cb96acdf810712aa562db8dfa3dbef00000000000000000000000000000000000000000000000000000000000f3a70494b222acbfea7880870929f8af523e17ca8dd41418776ca8ae7b10c3f283a610000000000000000000000000000000000000000000000000000000031408f8e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000068c2d2fe000000000000000000000000000000000000000000000000000000000000008900000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000accc1fe6537eb8eb56b31ccfc48eb9363e8dd32e000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f00000000000000000000000000000000000000000000000000000000000007d000000000000000000000000000000000000000000000000000000000000000416e5372b9cf93209c2bfd3f1cb5ea2ed73de499926f4d4e8dfa3adbcea94ba0d372d44516b31a48cb5144b4be24883178f5395ddf657d74e3ff9f794519f48d761b00000000000000000000000000000000000000000000000000000000000000",
    //       value: 0
    //     }]),
    // })
    // console.log('abstractedSendTransaction', polygonSendTransaction)
  } catch (e) {
    console.log(e)
  }
}

init()